{"data":{"markdownRemark":{"html":"<p>I have been developing a lot of windows workflows and web services in .NET recently. I came across a need to convert a WMF file (Windows Meta File) into a gif file. SQL Server Reporting Services can not display WMF files.</p>\n<p>.NET 2.0 can convert and resize images natively. Here is how I converted the WMF files. First I added the following using statements;</p>\n<p>[code:c#]</p>\n<p>using System.Drawing;</p>\n<p>using System.Drawing.Imaging;</p>\n<p>[/code]></p>\n<p>InfoPath saves images as Base64 strings, and .NET treats this as a byte array. So I had to convert the WMF byte array to a gif byte array.</p>\n<p>[code:c#]</p>\n<p>byte[] imageByteArray = DiagramImage;</p>\n<p>MemoryStream inStream = new MemoryStream(imageByteArray);</p>\n<p>StreamReader myStreamReader = new StreamReader(inStream);</p>\n<p>Image myImage = Image.FromStream(inStream);</p>\n<p>Bitmap myBitmap = new Bitmap(myImage);</p>\n<p>Graphics myGraphics = Graphics.FromImage(myBitmap);</p>\n<p>//Keep background white.</p>\n<p>myGraphics.Clear(Color.White);</p>\n<p>myGraphics.DrawImage(myImage, 0, 0, myImage.Width, myImage.Height);</p>\n<p>MemoryStream outStream = new MemoryStream();</p>\n<p>myBitmap.Save(outStream, ImageFormat.Gif);</p>\n<p>byte[] gifByteArray = outStream.GetBuffer();</p>\n<p>[/code]></p>","frontmatter":{"title":"Converting Image files in InfoPath to gifs once submitted","date":"17.01.2011","category":"Blog"},"timeToRead":1}},"pageContext":{"slug":"/converting-image-files-in-info-path-to-gifs-once-submitted","prev":{"fields":{"slug":"/converting-wmf-files-to-gif-files-in-cold-fusion-8-using-the-net-interop"},"frontmatter":{"title":"Converting WMF files to Gif files in ColdFusion 8 using the .NET interop","category":"Blog"}},"next":{"fields":{"slug":"/congratulations-to-the-tampa-bay-rays"},"frontmatter":{"title":"Congratulations to the Tampa Bay Rays","category":"Blog"}}}}
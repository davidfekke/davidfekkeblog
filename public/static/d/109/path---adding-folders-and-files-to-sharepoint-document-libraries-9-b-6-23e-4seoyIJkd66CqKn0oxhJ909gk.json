{"data":{"markdownRemark":{"html":"<p>I am working on project now where we are creating reports and saving them to a document library in Sharepoint 3. I am automating this by using .NET code to create the subdirectories and files in the document library. I have not seen a lot of good code examples on how to do this on the internet, but this is how I am doing it in C#.</p>\n<p>When I add a folder to the document library I used the following code;</p>\n<pre class=\"brush: csharp;\">SPSite mySite = new SPSite(\"http://sitename/\");\nSPWeb myWeb = mySite.AllWebs[\"mywebname\"];\n\nSPFolderCollection myFolderCollection = myWeb.GetFolder(\"http://sitename/sites/mywebname/PDF Reports\").SubFolders;\nmyFolderCollection.Add(\"FolderName\");\n</pre>\n<p>To add a file from a filestream, I used the following code;</p>\n<pre class=\"brush: csharp;\">FileStream stream = File.Create(\"report.pdf\", result.Length);\n\nSPSite mySite = new SPSite(\"http://sitename/\");\nSPWeb myWeb = mySite.AllWebs[\"mywebname\"];\n\nSPFileCollection destFiles = myWeb.GetFolder(\"http://sitename/sites/mywebname/PDF Reports/FolderName\").Files;\ndestFiles.Add(\"report.pdf\", stream, true);\n\nstream.Close();\n</pre>","frontmatter":{"title":"Adding folders and files to Sharepoint document libraries","date":"21.01.2011","category":"Blog"},"timeToRead":1}},"pageContext":{"slug":"/adding-folders-and-files-to-sharepoint-document-libraries","prev":{"fields":{"slug":"/scott-guthrie-on-mvc-2-model-validation"},"frontmatter":{"title":"Scott Guthrie on MVC 2 Model Validation","category":"Blog"}},"next":{"fields":{"slug":"/privacy-policy-added-to-fekke-com"},"frontmatter":{"title":"Privacy Policy added to Fekke.com","category":"Blog"}}}}
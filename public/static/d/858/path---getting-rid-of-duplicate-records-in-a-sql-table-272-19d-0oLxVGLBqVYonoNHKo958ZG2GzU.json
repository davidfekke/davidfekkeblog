{"data":{"markdownRemark":{"html":"<p>Here is a simple way of getting rid of duplicate records in a SQL Server table. This comes up frequently when a customer gives you bad data. You can clean this up in temp tables before adding it to the actual database.</p>\n<div class=\"code\">DELETE temp_Table  \n<p>WHERE SOME<em>UNIQUE</em>CODE IN (SELECT SOME<em>UNIQUE</em>CODE  </p>\n<p>FROM temp_Table  </p>\n<p>GROUP BY SOME<em>UNIQUE</em>CODE  </p>\n<p>HAVING COUNT(SOME<em>UNIQUE</em>CODE) > 1)  </p>\n<p>AND tempPrimaryKeyID NOT IN (SELECT MIN(tempPrimaryKeyID)  </p>\n<p>FROM temp_Table  </p>\n<p>GROUP BY SOME<em>UNIQUE</em>CODE  </p>\n<p>HAVING COUNT(SOME<em>UNIQUE</em>CODE) > 1);  </p>\n<p>GO</p>\n</div>\nSo by using the HAVING clause, you can check for a count greater than one on the column that has been duplicated using the COUNT() aggregate function. You can then filter out the records you want to keep by using the MIN() aggregate function on the column that is truly unique.","frontmatter":{"title":"Getting rid of duplicate records in a SQL Table","date":"17.01.2011","category":"Blog"},"timeToRead":1}},"pageContext":{"slug":"/getting-rid-of-duplicate-records-in-a-sql-table","prev":{"fields":{"slug":"/giant-sql-injection-spider-attack"},"frontmatter":{"title":"Giant SQL Injection Spider Attack","category":"Blog"}},"next":{"fields":{"slug":"/george-carlin-the-earth-wants-our-plastic"},"frontmatter":{"title":"George Carlin \"The Earth wants our Plastic\"","category":"Blog"}}}}